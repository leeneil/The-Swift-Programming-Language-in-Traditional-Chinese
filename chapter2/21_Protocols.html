<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>協議 | Swift 雨燕編程語言 繁體中文版</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="SwiftPlus">
    
    
    <link rel="next" href="../chapter2/22_Generics.html" />
    
    
    <link rel="prev" href="../chapter2/20_Extensions.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-github="SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese" data-level="2.21" data-basepath=".." data-revision="1402808251858">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Swift 雨燕編程語言 繁體中文版</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/SwiftPlus" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/SwiftPlus/The-Swift-Programming-Language-in-Traditional-Chinese/edit/master/chapter2/21_Protocols.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="chapter1/chapter1.html">
            
            <a href="../chapter1/chapter1.html">
                <i class="fa fa-check"></i> <b>1.</b> 歡迎使用 Swift
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="chapter1/01_swift.html">
            
            <a href="../chapter1/01_swift.html">
                <i class="fa fa-check"></i> <b>1.1.</b> 關於 Swift
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1/02_a_swift_tour.html">
            
            <a href="../chapter1/02_a_swift_tour.html">
                <i class="fa fa-check"></i> <b>1.2.</b> Swift 初見
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="chapter2/chapter2.html">
            
            <a href="../chapter2/chapter2.html">
                <i class="fa fa-check"></i> <b>2.</b> Swift 教程
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="chapter2/01_The_Basics.html">
            
            <a href="../chapter2/01_The_Basics.html">
                <i class="fa fa-check"></i> <b>2.1.</b> 基础部分
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="chapter2/02_Basic_Operators.html">
            
            <a href="../chapter2/02_Basic_Operators.html">
                <i class="fa fa-check"></i> <b>2.2.</b> 基本運算符
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="chapter2/03_Strings_and_Characters.html">
            
            <a href="../chapter2/03_Strings_and_Characters.html">
                <i class="fa fa-check"></i> <b>2.3.</b> 字符串和字符
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="chapter2/04_Collection_Types.html">
            
            <a href="../chapter2/04_Collection_Types.html">
                <i class="fa fa-check"></i> <b>2.4.</b> 集合類型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="chapter2/05_Control_Flow.html">
            
            <a href="../chapter2/05_Control_Flow.html">
                <i class="fa fa-check"></i> <b>2.5.</b> 控制流
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="chapter2/06_Functions.html">
            
            <a href="../chapter2/06_Functions.html">
                <i class="fa fa-check"></i> <b>2.6.</b> 函數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="chapter2/07_Closures.html">
            
            <a href="../chapter2/07_Closures.html">
                <i class="fa fa-check"></i> <b>2.7.</b> 閉包
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="chapter2/08_Enumerations.html">
            
            <a href="../chapter2/08_Enumerations.html">
                <i class="fa fa-check"></i> <b>2.8.</b> 枚舉
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="chapter2/09_Classes_and_Structures.html">
            
            <a href="../chapter2/09_Classes_and_Structures.html">
                <i class="fa fa-check"></i> <b>2.9.</b> 類和結構體
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="chapter2/10_Properties.html">
            
            <a href="../chapter2/10_Properties.html">
                <i class="fa fa-check"></i> <b>2.10.</b> 屬性
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="chapter2/11_Methods.html">
            
            <a href="../chapter2/11_Methods.html">
                <i class="fa fa-check"></i> <b>2.11.</b> 方法
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="chapter2/12_Subscripts.html">
            
            <a href="../chapter2/12_Subscripts.html">
                <i class="fa fa-check"></i> <b>2.12.</b> 附屬腳本
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="chapter2/13_Inheritance.html">
            
            <a href="../chapter2/13_Inheritance.html">
                <i class="fa fa-check"></i> <b>2.13.</b> 繼承
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="chapter2/14_Initialization.html">
            
            <a href="../chapter2/14_Initialization.html">
                <i class="fa fa-check"></i> <b>2.14.</b> 構造過程
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="chapter2/15_Deinitialization.html">
            
            <a href="../chapter2/15_Deinitialization.html">
                <i class="fa fa-check"></i> <b>2.15.</b> 析構過程
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="chapter2/16_Automatic_Reference_Counting.html">
            
            <a href="../chapter2/16_Automatic_Reference_Counting.html">
                <i class="fa fa-check"></i> <b>2.16.</b> 自動引用計數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="chapter2/17_Optional_Chaining.html">
            
            <a href="../chapter2/17_Optional_Chaining.html">
                <i class="fa fa-check"></i> <b>2.17.</b> 可選鏈
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="chapter2/18_Type_Casting.html">
            
            <a href="../chapter2/18_Type_Casting.html">
                <i class="fa fa-check"></i> <b>2.18.</b> 類型轉換
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="chapter2/19_Nested_Types.html">
            
            <a href="../chapter2/19_Nested_Types.html">
                <i class="fa fa-check"></i> <b>2.19.</b> 類型嵌套
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="chapter2/20_Extensions.html">
            
            <a href="../chapter2/20_Extensions.html">
                <i class="fa fa-check"></i> <b>2.20.</b> 擴展
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="chapter2/21_Protocols.html">
            
            <a href="../chapter2/21_Protocols.html">
                <i class="fa fa-check"></i> <b>2.21.</b> 協議
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="chapter2/22_Generics.html">
            
            <a href="../chapter2/22_Generics.html">
                <i class="fa fa-check"></i> <b>2.22.</b> 泛型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="chapter2/23_Advanced_Operators.html">
            
            <a href="../chapter2/23_Advanced_Operators.html">
                <i class="fa fa-check"></i> <b>2.23.</b> 高級運算符
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="chapter3/chapter3.html">
            
            <a href="../chapter3/chapter3.html">
                <i class="fa fa-check"></i> <b>3.</b> 語言參考
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="chapter3/01_About_the_Language_Reference.html">
            
            <a href="../chapter3/01_About_the_Language_Reference.html">
                <i class="fa fa-check"></i> <b>3.1.</b> 關於語言附註
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="chapter3/02_Lexical_Structure.html">
            
            <a href="../chapter3/02_Lexical_Structure.html">
                <i class="fa fa-check"></i> <b>3.2.</b> 詞法結構
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="chapter3/03_Types.html">
            
            <a href="../chapter3/03_Types.html">
                <i class="fa fa-check"></i> <b>3.3.</b> 類型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="chapter3/04_Expressions.html">
            
            <a href="../chapter3/04_Expressions.html">
                <i class="fa fa-check"></i> <b>3.4.</b> 表達式
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="chapter3/10_Statements.html">
            
            <a href="../chapter3/10_Statements.html">
                <i class="fa fa-check"></i> <b>3.5.</b> 語句
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="chapter3/05_Declarations.html">
            
            <a href="../chapter3/05_Declarations.html">
                <i class="fa fa-check"></i> <b>3.6.</b> 聲明
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="chapter3/06_Attributes.html">
            
            <a href="../chapter3/06_Attributes.html">
                <i class="fa fa-check"></i> <b>3.7.</b> 特性
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="chapter3/07_Patterns.html">
            
            <a href="../chapter3/07_Patterns.html">
                <i class="fa fa-check"></i> <b>3.8.</b> 模式
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="chapter3/08_Generic_Parameters_and_Arguments.html">
            
            <a href="../chapter3/08_Generic_Parameters_and_Arguments.html">
                <i class="fa fa-check"></i> <b>3.9.</b> 泛型參數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="chapter3/09_Summary_of_the_Grammar.html">
            
            <a href="../chapter3/09_Summary_of_the_Grammar.html">
                <i class="fa fa-check"></i> <b>3.10.</b> 语法总结
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 47.36842105263158%;min-width: 44.73684210526316%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../chapter1/chapter1.html" title="歡迎使用 Swift" class="chapter done new-chapter" data-progress="1" style="left: 2.6315789473684212%;"></a>
    
        <a href="../chapter1/01_swift.html" title="關於 Swift" class="chapter done " data-progress="1.1" style="left: 5.2631578947368425%;"></a>
    
        <a href="../chapter1/02_a_swift_tour.html" title="Swift 初見" class="chapter done " data-progress="1.2" style="left: 7.894736842105263%;"></a>
    
        <a href="../chapter2/chapter2.html" title="Swift 教程" class="chapter done new-chapter" data-progress="2" style="left: 10.526315789473685%;"></a>
    
        <a href="../chapter2/01_The_Basics.html" title="基础部分" class="chapter done " data-progress="2.1" style="left: 13.157894736842104%;"></a>
    
        <a href="../chapter2/10_Properties.html" title="屬性" class="chapter done " data-progress="2.10" style="left: 15.789473684210526%;"></a>
    
        <a href="../chapter2/11_Methods.html" title="方法" class="chapter done " data-progress="2.11" style="left: 18.42105263157895%;"></a>
    
        <a href="../chapter2/12_Subscripts.html" title="附屬腳本" class="chapter done " data-progress="2.12" style="left: 21.05263157894737%;"></a>
    
        <a href="../chapter2/13_Inheritance.html" title="繼承" class="chapter done " data-progress="2.13" style="left: 23.68421052631579%;"></a>
    
        <a href="../chapter2/14_Initialization.html" title="構造過程" class="chapter done " data-progress="2.14" style="left: 26.31578947368421%;"></a>
    
        <a href="../chapter2/15_Deinitialization.html" title="析構過程" class="chapter done " data-progress="2.15" style="left: 28.94736842105263%;"></a>
    
        <a href="../chapter2/16_Automatic_Reference_Counting.html" title="自動引用計數" class="chapter done " data-progress="2.16" style="left: 31.57894736842105%;"></a>
    
        <a href="../chapter2/17_Optional_Chaining.html" title="可選鏈" class="chapter done " data-progress="2.17" style="left: 34.21052631578947%;"></a>
    
        <a href="../chapter2/18_Type_Casting.html" title="類型轉換" class="chapter done " data-progress="2.18" style="left: 36.8421052631579%;"></a>
    
        <a href="../chapter2/19_Nested_Types.html" title="類型嵌套" class="chapter done " data-progress="2.19" style="left: 39.473684210526315%;"></a>
    
        <a href="../chapter2/02_Basic_Operators.html" title="基本運算符" class="chapter done " data-progress="2.2" style="left: 42.10526315789474%;"></a>
    
        <a href="../chapter2/20_Extensions.html" title="擴展" class="chapter done " data-progress="2.20" style="left: 44.73684210526316%;"></a>
    
        <a href="../chapter2/21_Protocols.html" title="協議" class="chapter done " data-progress="2.21" style="left: 47.36842105263158%;"></a>
    
        <a href="../chapter2/22_Generics.html" title="泛型" class="chapter  " data-progress="2.22" style="left: 50%;"></a>
    
        <a href="../chapter2/23_Advanced_Operators.html" title="高級運算符" class="chapter  " data-progress="2.23" style="left: 52.63157894736842%;"></a>
    
        <a href="../chapter2/03_Strings_and_Characters.html" title="字符串和字符" class="chapter  " data-progress="2.3" style="left: 55.26315789473684%;"></a>
    
        <a href="../chapter2/04_Collection_Types.html" title="集合類型" class="chapter  " data-progress="2.4" style="left: 57.89473684210526%;"></a>
    
        <a href="../chapter2/05_Control_Flow.html" title="控制流" class="chapter  " data-progress="2.5" style="left: 60.526315789473685%;"></a>
    
        <a href="../chapter2/06_Functions.html" title="函數" class="chapter  " data-progress="2.6" style="left: 63.1578947368421%;"></a>
    
        <a href="../chapter2/07_Closures.html" title="閉包" class="chapter  " data-progress="2.7" style="left: 65.78947368421052%;"></a>
    
        <a href="../chapter2/08_Enumerations.html" title="枚舉" class="chapter  " data-progress="2.8" style="left: 68.42105263157895%;"></a>
    
        <a href="../chapter2/09_Classes_and_Structures.html" title="類和結構體" class="chapter  " data-progress="2.9" style="left: 71.05263157894737%;"></a>
    
        <a href="../chapter3/chapter3.html" title="語言參考" class="chapter  new-chapter" data-progress="3" style="left: 73.6842105263158%;"></a>
    
        <a href="../chapter3/01_About_the_Language_Reference.html" title="關於語言附註" class="chapter  " data-progress="3.1" style="left: 76.3157894736842%;"></a>
    
        <a href="../chapter3/09_Summary_of_the_Grammar.html" title="语法总结" class="chapter  " data-progress="3.10" style="left: 78.94736842105263%;"></a>
    
        <a href="../chapter3/02_Lexical_Structure.html" title="詞法結構" class="chapter  " data-progress="3.2" style="left: 81.57894736842105%;"></a>
    
        <a href="../chapter3/03_Types.html" title="類型" class="chapter  " data-progress="3.3" style="left: 84.21052631578948%;"></a>
    
        <a href="../chapter3/04_Expressions.html" title="表達式" class="chapter  " data-progress="3.4" style="left: 86.84210526315789%;"></a>
    
        <a href="../chapter3/10_Statements.html" title="語句" class="chapter  " data-progress="3.5" style="left: 89.47368421052632%;"></a>
    
        <a href="../chapter3/05_Declarations.html" title="聲明" class="chapter  " data-progress="3.6" style="left: 92.10526315789474%;"></a>
    
        <a href="../chapter3/06_Attributes.html" title="特性" class="chapter  " data-progress="3.7" style="left: 94.73684210526316%;"></a>
    
        <a href="../chapter3/07_Patterns.html" title="模式" class="chapter  " data-progress="3.8" style="left: 97.36842105263158%;"></a>
    
        <a href="../chapter3/08_Generic_Parameters_and_Arguments.html" title="泛型參數" class="chapter  " data-progress="3.9" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_738">
                    
                        <blockquote>
<p>翻譯：CMW</p>
<h1 id="-">協議</h1>
<hr>
</blockquote>
<p>本頁包含內容：</p>
<ul>
<li><a href="#protocol_syntax">協議的語法（Protocol Syntax）</a></li>
<li><a href="#property_requirements">屬性要求（Property Requirements）</a></li>
<li><a href="#method_requirements">方法要求（Method Requirements）</a></li>
<li><a href="#mutating_method_requirements">突變方法要求（Mutating Method Requirements）</a></li>
<li><a href="#protocols_as_types">協議類型（Protocols as Types）</a></li>
<li><a href="#delegation">委託(代理)模式（Delegation）</a></li>
<li><a href="#adding_protocol_conformance_with_an_extension">在擴展中添加協議成員（Adding Protocol Conformance with an Extension）</a></li>
<li><a href="#declaring_protocol_adoption_with_an_extension">通過延展補充協議聲明（Declaring Protocol Adoption with an Extension）</a></li>
<li><a href="#collections_of_protocol_types">集合中的協議類型（Collections of Protocol Types）</a></li>
<li><a href="#protocol_inheritance">協議的繼承（Protocol Inheritance）</a></li>
<li><a href="#protocol_composition">協議合成（Protocol Composition）</a></li>
<li><a href="#checking_for_protocol_conformance">檢驗協議的一致性（Checking for Protocol Conformance）</a></li>
<li><a href="#optional_protocol_requirements">可選協議要求（Optional Protocol Requirements）</a></li>
</ul>
<p><code>Protocol(協議)</code>用於<strong>統一</strong>方法和屬性的名稱，而不實現任何功能。 <code>協議</code>能夠被類，枚舉，結構體實現，滿足協議要求的類，枚舉，結構體被稱為協議的<code>遵循者</code>。</p>
<p><code>遵循者</code>需要提供<code>協議</code>指定的成員，如屬性，方法，操作符，下標等。</p>
<p><a name="protocol_syntax"></a></p>
<h2 id="-">協議的語法</h2>
<p><code>協議</code>的定義與類，結構體，枚舉的定義非常相似，如下所示：</p>
<p>protocol SomeProtocol {
// 協議內容
}</p>
<p>在類，結構體，枚舉的名稱後加上<code>協議名稱</code>，中間以冒號<code>:</code>分隔即可實現協議；實現多個協議時，各協議之間用逗號<code>,</code>分隔，如下所示：</p>
<p>struct SomeStructure: FirstProtocol, AnotherProtocol {
// 結構體內容
}</p>
<p>當某個類含有父類的同時並實現了協議，應當​​把父類放在所有的協議之前，如下所示：</p>
<p>class SomeClass: SomeSuperClass, FirstProtocol, AnotherProtocol {
// 類的內容
}</p>
<p><a name="property_requirements"></a></p>
<h2 id="-">屬性要求</h2>
<p><code>協議</code>能夠要求其<code>遵循者</code>必須含有一些<strong>特定名​​稱和類型</strong>的<code>實例屬性(instance property)</code>或<code>類屬性(type property)</code>，也能夠要求屬性的<code>(設置權限) settable</code> 和<code>(訪問權限)gettable</code>，但它不要求<code>屬性</code>是<code>存儲型屬性(stored property)</code>還是<code>計算型屬性(calculate property)</code>。</p>
<p>通常前置<code>var</code>關鍵字將屬性聲明為變量。在屬性聲明後寫上<code>{ get set }</code>表示屬性為可讀寫的。 <code>{ get }</code>用來表示屬性為可讀的。即使你為可讀的屬性實現了<code>setter</code>方法，它也不會出錯。</p>
<p>protocol SomeProtocol {
var musBeSettable : Int { get set }
var doesNotNeedToBeSettable: Int { get }
}</p>
<p>用類來實現協議時，使用<code>class</code>關鍵字來表示該屬性為類成員；用結構體或枚舉實現協議時，則使用<code>static</code>關鍵字來表示：</p>
<p>protocol AnotherProtocol {
class var someTypeProperty: Int { get set }
}</p>
<p>protocol FullyNamed {
var fullName: String { get }
}</p>
<p><code>FullyNamed</code>協議含有<code>fullName</code>屬性。因此其<code>遵循者</code>必須含有一個名為<code>fullName</code>，類型為<code>String</code>的可讀屬性。</p>
<p>struct Person: FullyNamed{
var fullName: String
}
let john = Person(fullName: &quot;John Appleseed&quot;)
//john.fullName 為 &quot;John Appleseed&quot;</p>
<p><code>Person</code>結構體含有一個名為<code>fullName</code>的<code>存儲型屬性</code>，完整的<code>遵循</code>了協議。 (<em>若協議未被完整遵循，編譯時則會報錯</em>)。</p>
<p>如下所示，<code>Startship</code>類<code>遵循</code>了<code>FullyNamed</code>協議：</p>
<p>class Starship: F​​ullyNamed {
var prefix: String?
var name: String
init(name: String, prefix: String? = nil ) {
self.anme = name
self.prefix = prefix
}
var fullName: String {
return (prefix ? prefix ! + &quot; &quot; : &quot; &quot;) + name
}
}
var ncc1701 = Starship(name: &quot;Enterprise&quot;, prefix: &quot;USS&quot;)
// ncc1701.fullName == &quot;USS Enterprise&quot;</p>
<p><code>Starship</code>類將<code>fullName</code>實現為可讀的<code>計算型屬性</code>。它的每一個實例都有一個名為<code>name</code>的必備屬性和一個名為<code>prefix</code>的可選屬性。當<code>prefix</code>存在時，將<code>prefix</code>插入到<code>name</code>之前來為<code>Starship</code>構建<code>fullName</code>。</p>
<p><a name="method_requirements"></a></p>
<h2 id="-">方法要求</h2>
<p><code>協議</code>能夠要求其<code>遵循者</code>必備某些特定的<code>實例方法</code>和<code>類方法</code>。協議方法的聲明與普通方法聲明相似，但它不需要<code>方法</code>內容。</p>
<blockquote>
<p>注意：</p>
<p>協議方法支持<code>變長參數(variadic parameter)</code>，不支持<code>默認參數(default parameter)</code>。</p>
</blockquote>
<p>前置<code>class</code>關鍵字表示協議中的成員為<code>類成員</code>；當協議用於被<code>枚舉</code>或<code>結構體</code>遵循時，則使用<code>static</code>關鍵字。如下所示：</p>
<p>protocol SomeProtocol {
class func someTypeMethod()
}</p>
<p>protocol RandomNumberGenerator {
func random() -&gt; Double
}</p>
<p><code>RandomNumberGenerator</code>協議要求其<code>遵循者</code>必須擁有一個名為<code>random</code>， 返回值類型為<code>Double</code>的實例方法。 (我們假設隨機數在[0，1]區間內)。</p>
<p><code>LinearCongruentialGenerator</code>類<code>遵循</code>了<code>RandomNumberGenerator</code>協議，並提供了一個叫做<em>線性同餘生成器(linear congruential generator)</em>的偽隨機數算法。</p>
<p>class LinearCongruentialGenerator: RandomNumberGenerator {
var lastRandom = 42.0
let m = 139968.0
let a = 3877.0
let c = 29573.0
func random() -&gt; Double {
lastRandom = ((lastRandom * a + c) % m)
return lastRandom / m
}
}
let generator = LinearCongruentialGenerator()
println(&quot;Here&#39;s a random number: (generator.random())&quot;)
// 輸出: &quot;Here&#39;s a random number: 0.37464991998171&quot;
println(&quot;And another one: (generator.random())&quot;)
// 輸出 : &quot;And another one: 0.729023776863283&quot;</p>
<p><a name="mutating_method_requirements"></a></p>
<h2 id="-">突變方法要求</h2>
<p>能在<code>方法</code>或<code>函數</code>內部改變實例類型的方法稱為<code>突變方法</code>。在<code>值類型(Value Type)</code>(<em>譯者註：特指結構體和枚舉</em>)中的的<code>函數</code>前綴加上<code>mutating</code>關鍵字來表示該函數允許改變該實例和其屬性的類型。這一變換過程在<a href="11_Methods.html#instance_methods">實例方法(Instance Methods)</a>章節中有詳細描述。</p>
<p>(<em>譯者註：類中的成員為<code>引用類型(Reference Type)</code>，可以方便的修改實例及其屬性的值而無需改變類型；而<code>結構體</code>和<code>枚舉</code>中的成員均為<code>值類型(Value Type)</code>，修改變量的值就相當於修改變量的類型，而<code>Swift</code>默認不允許修改類型，因此需要前置<code>mutating</code>關鍵字用來表示該<code>函數</code>中能夠修改類型</em>)</p>
<blockquote>
<p>注意：</p>
<p>用<code>class</code>實現協議中的<code>mutating</code>方法時，不用寫<code>mutating</code>關鍵字；用<code>結構體</code>，<code>枚舉</code>實現協議中的<code>mutating</code>方法時，必須寫<code>mutating</code>關鍵字。</p>
</blockquote>
<p>如下所示，<code>Togglable</code>協議含有<code>toggle</code>函數。根據函數名稱推測，<code>toggle</code>可能用於<strong>切換或恢復</strong>某個屬性的狀態。 <code>mutating</code>關鍵字表示它為<code>突變方法</code>：</p>
<p>protocol Togglable {
mutating func toggle()
}</p>
<p>當使用<code>枚舉</code>或<code>結構體</code>來實現<code>Togglabl</code>協議時，必須在<code>toggle</code>方法前加上<code>mutating</code>關鍵字。</p>
<p>如下所示，<code>OnOffSwitch</code>枚舉<code>遵循</code>了<code>Togglable</code>協議，<code>On</code>，<code>Off</code>兩個成員用於表示當前狀態</p>
<p>enum OnOffSwitch: Togglable {
case Off, On
mutating func toggle() {
switch self {
case Off:
self = On
case On:
self = Off
}
}
}
var lightSwitch = OnOffSwitch.Off
lightSwitch.toggle()
//lightSwitch 現在的值為 .On</p>
<p><a name="protocols_as_types"></a></p>
<h2 id="-">協議類型</h2>
<p><code>協議</code>本身不實現任何功能，但你可以將它當做<code>類型</code>來使用。</p>
<p>使用場景：</p>
<ul>
<li>作為函數，方法或構造器中的參數類型，返回值類型</li>
<li>作為常量，變量，屬性的類型</li>
<li>作為數組，字典或其他容器中的元素類型</li>
</ul>
<blockquote>
<p>注意：</p>
<p>協議類型應與其他類型(Int，Double，String)的寫法相同，使用駝峰式</p>
</blockquote>
<p>class Dice {
let sides: Int
let generator: RandomNumberGenerator
init(sides: Int, generator: RandomNumberGenerator) {
self.sides = sides
self.generator = generator
}
func roll() -&gt; Int {
return Int(generator.random() * Double(sides)) +1
}
}</p>
<p>這裡定義了一個名為<code>Dice</code>的類，用來代表桌遊中的N個面的骰子。</p>
<p> <code>Dice</code>含有<code>sides</code>和<code>generator</code>兩個屬性，前者用來表示骰子有幾個面，後者為骰子提供一個隨機數生成器。由於後者為<code>RandomNumberGenerator</code>的協議類型。所以它能夠被賦值為任意<code>遵循</code>該協議的類型。</p>
<p>此外，使用<code>構造器(init)</code>來代替之前版本中的<code>setup</code>操作。構造器中含有一個名為<code>generator</code>，類型為<code>RandomNumberGenerator</code>的形參，使得它可以接收任意遵循<code>RandomNumberGenerator</code>協議的類型。</p>
<p><code>roll</code>方法用來模擬骰子的面值。它先使用<code>generator</code>的<code>random</code>方法來創建一個[0-1]區間內的隨機數種子，然後加工這個隨機數種子生成骰子的面值。</p>
<p>如下所示，<code>LinearCongruentialGenerator</code>的實例作為隨機數生成器傳入<code>Dice</code>的<code>構造器</code></p>
<p>var d6 = Dice(sides: 6,generator: LinearCongruentialGenerator())
for _ in 1...5 {
println(&quot;Random dice roll is (d6.roll())&quot;)
}
//輸出結果
//Random dice roll is 3
//Random dice roll is 5
//Random dice roll is 4
//Random dice roll is 5
//Random dice roll is 4</p>
<p><a name="d​​elegation"></a></p>
<h2 id="-">委託(代理)模式</h2>
<p>委託是一種設計模式，它允許類或結構體將一些需要它們負責的功能<code>交由(委託)</code>給其他的類型。</p>
<p>委託模式的實現很簡單： 定義<code>協議</code>來<code>封裝</code>那些需要被委託的<code>函數和方法</code>， 使其<code>遵循者</code>擁有這些被委託的<code>函數和方法</code>。</p>
<p>委託模式可以用來響應特定的動作或接收外部數據源提供的數據，而無需要知道外部數據源的類型。</p>
<p>下文是兩個基於骰子遊戲的協議：</p>
<p>protocol DiceGame {
var dice: Dice { get }
func play()
}
protocol DiceGameDelegate {
func gameDidStart(game: DiceGame)
func game(game: DiceGame, didStartNewTurnWithDiceRoll diceRoll:Int)
func gameDidEnd(game: DiceGame)
}</p>
<p><code>DiceGame</code>協議可以在任意含有骰子的遊戲中實現，<code>DiceGameDelegate</code>協議可以用來追踪<code>DiceGame</code>的遊戲過程。</p>
<p>如下所示，<code>SnakesAndLadders</code>是<code>Snakes and Ladders</code>(譯者註：<a href="05_Control_Flow.html">控制流</a>章節有該遊戲的​​詳細介紹)遊戲的新版本。新版本使用<code>Dice</code>作為骰子，並且實現了<code>DiceGame</code>和<code>DiceGameDelegate</code>協議</p>
<p>class SnakesAndLadders: DiceGame {
let finalSquare = 25
let dic = Dice(sides: 6, generator: LinearCongruentialGenerator())
var square = 0
var board: Int[]
init() {
board = Int<a href="count: finalSquare + 1, repeatedValue: 0" target="_blank"></a>
board[03] = +08; board[06] = +11; borad[09] = +09; board[10] = +02
borad[14] = -10; board[19] = -11; borad[22] = -02; board[24] = -08
}
 var delegate: DiceGameDelegate?
 func play() {
 square = 0
 delegate?.gameDidStart(self)
 gameLoop: while square != finalSquare {
 let diceRoll = dice.roll()
 delegate?.game(self,didStartNewTurnWithDiceRoll: diceRoll)
 switch square + diceRoll {
 case finalSquare:
break gameLoop
 case let newSquare where newSquare &gt; finalSquare:
 continue gameLoop
 default:
 square += diceRoll
 square += board[square]
 }
 }
 delegate?.gameDIdEnd(self)
 }
}</p>
<p>遊戲的<code>初始化設置(setup)</code>被<code>SnakesAndLadders</code>類的<code>構造器(initializer)</code>實現。所有的遊戲邏輯被轉移到了<code>play</code>方法中。</p>
<blockquote>
<p>注意：</p>
<p>因為<code>delegate</code>並不是該遊戲的必備條件，<code>delegate</code>被定義為遵循<code>DiceGameDelegate</code>協議的可選屬性</p>
</blockquote>
<p><code>DicegameDelegate</code>協議提供了三個方法用來追踪遊戲過程。被放置於遊戲的邏輯中，即<code>play()</code>方法內。分別在遊戲開始時，新一輪開始時，遊戲結束時被調用。</p>
<p>因為<code>delegate</code>是一個遵循<code>DiceGameDelegate</code>的可選屬性，因此在<code>play()</code>方法中使用了<code>可選鏈</code>來調用委託方法。若<code>delegate</code>屬性為<code>nil</code>， 則委託調用<em>優雅地</em>失效。若<code>delegate</code>不為<code>nil</code>，則委託方法被調用</p>
<p>如下所示，<code>DiceGameTracker</code>遵循了<code>DiceGameDelegate</code>協議</p>
<p>class DiceGameTracker: DiceGameDelegate {
    var numberOfTurns = 0
func gameDidStart(game: DiceGame) {
        numberOfTurns = 0
    if game is SnakesAndLadders {
println(&quot;Started a new game of Snakes and Ladders&quot;)
}
    println(&quot;The game is using a (game.dice.sides)-sided dice&quot;)
}
    func game(game: DiceGame, didStartNewTurnWithDiceRoll diceRoll: Int) {
++numberOfTurns
        println(&quot;Rolled a (diceRoll)&quot;)
    }
func gameDidEnd(game: DiceGame) {
        println(&quot;The game lasted for (numberOfTurns) turns&quot;)
    }
}</p>
<p><code>DiceGameTracker</code>實現了<code>DiceGameDelegate</code>協議的方法要求，用來記錄遊戲已經進行的輪數。當遊戲開始時，<code>numberOfTurns</code>屬性被賦值為0；在每新一輪中遞加；遊戲結束後，輸出打印遊戲的總輪數。</p>
<p><code>gameDidStart</code>方法從<code>game</code>參數獲取遊戲信息並輸出。 <code>game</code>在方法中被當做<code>DiceGame</code>類型而不是<code>SnakeAndLadders</code>類型，所以方法中只能訪問<code>DiceGame</code>協議中的成員。</p>
<p><code>DiceGameTracker</code>的運行情況，如下所示：</p>
<p>“let tracker = DiceGameTracker()
let game = SnakesAndLadders()
game.delegate = tracker
game.play()
// Started a new game of Snakes and Ladders
// The game is using a 6-sided dice
// Rolled a 3
// Rolled a 5
// Rolled a 4
// Rolled a 5
// The game lasted for 4 turns”</p>
<p><a name="adding_protocol_conformance_with_an_extension"></a></p>
<h2 id="-">在擴展中添加協議成員</h2>
<p>即便無法修改源代碼，依然可以通過<code>擴展(Extension)</code>來擴充已存在類型(<em>譯者註： 類，結構體，枚舉等</em>)。 <code>擴展</code>可以為已存在的類型添加<code>屬性</code>，<code>方法</code>，<code>下標</code>，<code>協議</code>等成員。詳情請在<a href="20_Extensions.html">擴展</a>章節中查看。</p>
<blockquote>
<p>注意：</p>
<p>通過<code>擴展</code>為已存在的類型<code>遵循</code>協議時，該類型的所有實例也會隨之添加協議中的方法</p>
</blockquote>
<p><code>TextRepresentable</code>協議含有一個<code>asText</code>，如下所示：</p>
<p>protocol TextRepresentable {
func asText() -&gt; String
}</p>
<p>通過<code>擴展</code>為上一節中提到的<code>Dice</code>類遵循<code>TextRepresentable</code>協議</p>
<p>extension Dice: TextRepresentable {
cun asText() -&gt; String {
return &quot;A (sides)-sided dice&quot;
}
}</p>
<p>從現在起，<code>Dice</code>類型的實例可被當作<code>TextRepresentable</code>類型：</p>
<p>let d12 = Dice(sides: 12,generator: LinearCongruentialGenerator())
println(d12.asText())
// 輸出 &quot;A 12-sided dice&quot;</p>
<p><code>SnakesAndLadders</code>類也可以通過<code>擴展</code>的方式來遵循協議：</p>
<p>extension SnakeAndLadders: TextRepresentable {
func asText() -&gt; String {
return &quot;A game of Snakes and Ladders with (finalSquare) squares&quot;
}
}
println(game.asText())
// 輸出&quot;A game of Snakes and Ladders with 25 squares&quot;</p>
<p><a name="d​​eclaring_protocol_adoption_with_an_extension"></a></p>
<h2 id="-">通過延展補充協議聲明</h2>
<p>當一個類型已經實現了協議中的所有要求，卻沒有聲明時，可以通過<code>擴展</code>來補充協議聲明：</p>
<p>struct Hamster {
var name: String
func asText() -&gt; String {
return &quot;A hamster named (name)&quot;
}
}
extension Hamster: TextRepresentabl {}</p>
<p>從現在起，<code>Hamster</code>的實例可以作為<code>TextRepresentable</code>類型使用</p>
<p>let simonTheHamster = Hamster(name: &quot;Simon&quot;)
let somethingTextRepresentable: TextRepresentabl = simonTheHamester
println(somethingTextRepresentable.asText())
// 輸出 &quot;A hamster named Simon&quot;</p>
<blockquote>
<p>注意：</p>
<p>即時滿足了協議的所有要求，類型也不會自動轉變，因此你必須為它做出明顯的協議聲明</p>
</blockquote>
<p><a name="collections_of_protocol_types"></a></p>
<h2 id="-">集合中的協議類型</h2>
<p>協議類型可以被集合使用，表示集合中的元素均為協議類型：</p>
<p>let things: TextRepresentable[] = [game,d12,simoTheHamster]</p>
<p>如下所示，<code>things</code>數組可以被直接遍歷，並調用其中元素的<code>asText()</code>函數：</p>
<p>for thing in things {
println(thing.asText())
}
// A game of Snakes and Ladders with 25 squares
// A 12-sided dice
// A hamster named Simon</p>
<p><code>thing</code>被當做是<code>TextRepresentable</code>類型而不是<code>Dice</code>，<code>DiceGame</code>，<code>Hamster</code>等類型。因此能且僅能調用<code>asText</code>方法</p>
<p><a name="protocol_inheritance"></a></p>
<h2 id="-">協議的繼承</h2>
<p>協議能夠<em>繼承</em>一到多個其他協議。語法與類的繼承相似，多個協議間用逗號<code>,</code>分隔</p>
<p>protocol InheritingProtocol: SomeProtocol, AnotherProtocol {
// 協議定義
}</p>
<p>如下所示，<code>PrettyTextRepresentable</code>協議繼承了<code>TextRepresentable</code>協議</p>
<p>protocol PrettyTextRepresentable: TextRepresentable {
func asPrettyText() -&gt; String
}</p>
<p><code>遵循``PrettyTextRepresentable</code>協議的同時，也需要<code>遵循</code>TextRepresentable`協議。</p>
<p>如下所示，用<code>擴展</code>為<code>SnakesAndLadders</code>遵循<code>PrettyTextRepresentable</code>協議：</p>
<p>extension SnakesAndLadders: PrettyTextRepresentable {
    func asPrettyText() -&gt; String {
        var output = asText() + &quot;:\n&quot;
        for index in 1...finalSquare {
            switch board[index] {
           case let ladder where ladder &gt; 0:
        output += &quot;▲ &quot;
    case let snake where snake &lt; 0:
output += &quot;▼ &quot;
            default:
                output += &quot;○ &quot;
            }
        }
        return output
    }
}</p>
<p>在<code>for in</code>中迭代出了<code>board</code>數組中的每一個元素：</p>
<ul>
<li>當從數組中迭代出的元素的值大於0時，用<code>▲</code>表示</li>
<li>當從數組中迭代出的元素的值小於0時，用<code>▼</code>表示</li>
<li>當從數組中迭代出的元素的值等於0時，用<code>○</code>表示</li>
</ul>
<p>任意<code>SankesAndLadders</code>的實例都可以使用<code>asPrettyText()</code>方法。</p>
<p>println(game.asPrettyText())
// A game of Snakes and Ladders with 25 squares:
// ○ ○ ▲ ○ ○ ▲ ○ ○ ▲ ▲ ○ ○ ○ ▼ ○ ○ ○ ○ ▼ ○ ○ ▼ ○ ▼ ○</p>
<p><a name="protocol_composition"></a></p>
<h2 id="-">協議合成</h2>
<p>一個協議可由多個協議採用<code>protocol&lt;SomeProtocol, AnotherProtocol&gt;</code>這樣的格式進行組合，稱為<code>協議合成(protocol composition)</code>。</p>
<p>舉個例子：</p>
<p>protocol Named {
    var name: String { get }
}
protocol Aged {
var age: Int { get }
}
struct Person: Named, Aged {
    var name: String
    var age: Int
}
func wishHappyBirthday(celebrator: protocol<Named, Aged>) {
    println(&quot;Happy birthday (celebrator.name) - you&#39;re (celebrator.age)!&quot;)
}
let birthdayPerson = Person(name: &quot;Malcolm&quot;, age: 21)
wishHappyBirthday(birthdayPerson)
// 輸出 &quot;Happy birthday Malcolm - you&#39;re 21!</p>
<p><code>Named</code>協議包含<code>String</code>類型的<code>name</code>屬性；<code>Aged</code>協議包含<code>Int</code>類型的<code>age</code>屬性。 <code>Person</code>結構體<code>遵循</code>了這兩個協議。</p>
<p><code>wishHappyBirthday</code>函數的形參<code>celebrator</code>的類型為<code>protocol&lt;Named,Aged&gt;</code>。可以傳入任意<code>遵循</code>這兩個協議的類型的實例</p>
<blockquote>
<p>注意：</p>
<p><code>協議合成</code>並不會生成一個新協議類型，而是將多個協議合成為一個臨時的協議，超出範圍後立即失效。</p>
</blockquote>
<p><a name="checking_for_protocol_conformance"></a></p>
<h2 id="-">檢驗協議的一致性</h2>
<p>使用<code>is</code>檢驗協議一致性，使用<code>as</code>將協議類型<code>向下轉換(downcast)</code>為的其他協議類型。檢驗與轉換的語法和之前相同(<em>詳情查看<a href="18_Type_Casting.html">類型檢查</a></em>)：</p>
<ul>
<li><code>is</code>操作符用來檢查實例是否<code>遵循</code>了某個<code>協議</code>。</li>
<li><code>as?</code>返回一個可選值，當實例<code>遵循</code>協議時，返回該協議類型；否則返回<code>nil</code></li>
<li><code>as</code>用以強制向下轉換型。</li>
</ul>
<pre><code>@objc protocol HasArea {
var area: Double { get }
}
</code></pre><blockquote>
<p>注意：</p>
<p><code>@objc</code>用來表示協議是可選的，也可以用來表示暴露給<code>Objective-C</code>的代碼，此外，<code>@objc</code>型協議只對<code>類</code>有效，因此只能在<code>類</code>中檢查協議的一致性。詳情查看<em><a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/BuildingCocoaApps/index.html#//apple_ref/doc/uid/ TP40014216" target="_blank">Using Siwft with Cocoa and Objectivei-c</a></em>。</p>
</blockquote>
<p>class Circle: HasArea {
    let pi = 3.1415927
    var radius: Double
    var area:≈radius }
    init(radius: Double) { self.radius = radius }
}
class Country: HasArea {
    var area: Double
    init(area: Double) { self.area = area }
}</p>
<p><code>Circle</code>和<code>Country</code>都遵循了<code>HasArea</code>協議，前者把<code>area</code>寫為計算型屬性（computed property），後者則把<code>area</code>寫為存儲型屬性（stored property）。</p>
<p>如下所示，<code>Animal</code>類沒有實現任何協議</p>
<p>class Animal {
var legs: Int
init(legs: Int) { self.legs = legs }
}</p>
<p><code>Circle,Country,Animal</code>並沒有一個相同的基類，所以採用<code>AnyObject</code>類型的數組來裝載在他們的實例，如下所示：</p>
<p>let objects: AnyObject[] = [
Circle(radius: 2.0),
Country(area: 243_610),
Animal(legs: 4)
]</p>
<p>如下所示，在迭代時檢查<code>object</code>數組的元素是否<code>遵循</code>了<code>HasArea</code>協議：</p>
<p>for object in objects {
if let objectWithArea = object as? HasArea {
println(&quot;Area is (objectWithArea.area)&quot;)
} else {
println(&quot;Something that doesn&#39;t have an area&quot;)
}
}
// Area is 12.5663708
// Area is 243610.0
// Something that doesn&#39;t have an area</p>
<p>當數組中的元素遵循<code>HasArea</code>協議時，通過<code>as?</code>操作符將其<code>可選綁定(optional binding)</code>到<code>objectWithArea</code>常量上。</p>
<p><code>objects</code>數組中元素的類型並不會因為<code>向下轉型</code>而改變，當它們被賦值給<code>objectWithArea</code>時只被視為<code>HasArea</code>類型，因此只有<code>area</code>屬性能夠被訪問。</p>
<p><a name="optional_protocol_requirements"></a></p>
<h2 id="-">可選協議要求</h2>
<p>可選協議含有可選成員，其<code>遵循者</code>可以選擇是否實現這些成員。在協議中使用<code>@optional</code>關鍵字作為前綴來定義可選成員。</p>
<p>可選協議在調用時使用<code>可選鏈</code>，詳細內容在<a href="17_Optional_Chaining.html">可選鏈</a>章節中查看。</p>
<p>像<code>someOptionalMethod?(someArgument)</code>一樣，你可以在可選方法名稱後加上<code>?</code>來檢查該方法是否被實現。 <code>可選方法</code>和<code>可選屬性</code>都會返回一個<code>可選值(optional value)</code>，當其不可訪問時，<code>?</code>之後語句不會執行，並返回<code>nil</code>。</p>
<blockquote>
<p>注意：</p>
<p>可選協議只能在含有<code>@objc</code>前綴的協議中生效。且<code>@objc</code>的協議只能被<code>類</code>遵循。</p>
</blockquote>
<p><code>Counter</code>類使用<code>CounterDataSource</code>類型的外部數據源來提供<code>增量值(increment amount)</code>，如下所示：</p>
<p>@objc protocol CounterDataSource {
    @optional func incrementForCount(count: Int) -&gt; Int
    @optional var fixedIncrement: Int { get }
}</p>
<p><code>CounterDataSource</code>含有<code>incrementForCount</code>的<code>可選方法</code>和<code>fiexdIncrement</code>的<code>可選屬性</code>。</p>
<blockquote>
<p>注意：</p>
<p><code>CounterDataSource</code>中的屬性和方法都是可選的，因此可以在類中聲明但不實現這些成員，儘管技術上允許這樣做，不過最好不要這樣寫。</p>
</blockquote>
<p><code>Counter</code>類含有<code>CounterDataSource?</code>類型的可選屬性<code>dataSource</code>，如下所示：</p>
<p>@objc class Counter {
var count = 0
var dataSource: CounterDataSource?
func increment() {
if let amount = dataSource?.incrementForCount?(count) {
count += amount
} else if let amount = dataSource?.fixedIncrement? {
count += amount
}
}
}</p>
<p><code>count</code>屬性用於存儲當前的值，<code>increment</code>方法用來為<code>count</code>賦值。</p>
<p><code>increment</code>方法通過<code>可選鏈</code>，嘗試從兩種<code>可選成員</code>中獲取<code>count</code>。</p>
<ol>
<li>由於<code>dataSource</code>可能為<code>nil</code>，因此在<code>dataSource</code>後邊加上了<code>?</code>標記來表明只在<code>dataSource</code>非空時才去調用incrementForCount`方法。</li>
<li>即使<code>dataSource</code>存在，但是也無法保證其是否實現了<code>incrementForCount</code>方法，因此在<code>incrementForCount</code>方法後邊也加有<code>?</code>標記。</li>
</ol>
<p>在調用<code>incrementForCount</code>方法後，<code>Int</code>型<code>可選值</code>通過<code>可選綁定(optional binding)</code>自動拆包並賦值給常量<code>amount</code>。</p>
<p>當<code>incrementForCount</code>不能被調用時，嘗試使用<code>可選屬性``fixedIncrement</code>來代替。</p>
<p><code>ThreeSource</code>實現了<code>CounterDataSource</code>協議，如下所示：</p>
<p>class ThreeSource: CounterDataSource {
let fixedIncrement = 3
}</p>
<p>使用<code>ThreeSource</code>作為數據源開實例化一個<code>Counter</code>：</p>
<p>var counter = Counter()
counter.dataSource = ThreeSource()
for _ in 1...4 {
counter.increment()
println(counter.count)
}
// 3
// 6
// 9
// 12</p>
<p><code>TowardsZeroSource</code>實現了<code>CounterDataSource</code>協議中的<code>incrementForCount</code>方法，如下所示：</p>
<p>class TowardsZeroSource: CounterDataSource {
    func incrementForCount(count: Int) -&gt; Int {
if count == 0 {
return 0
} else if count &lt; 0 {
return 1
} else {
return -1
}
    }
}</p>
<p>下邊是執行的代碼：</p>
<p>counter.count = -4
counter.dataSource = TowardsZeroSource()
for _ in 1...5 {
counter.increment()
println(counter.count)
}
// -3
// -2
// -1
// 0
// 0</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../chapter2/20_Extensions.html" class="navigation navigation-prev " aria-label="Previous page: 擴展"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../chapter2/22_Generics.html" class="navigation navigation-next " aria-label="Next page: 泛型"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
